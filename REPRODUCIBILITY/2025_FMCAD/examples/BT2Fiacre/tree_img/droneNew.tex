\documentclass[preview]{standalone}
\usepackage[utf8]{inputenc}
\usepackage{preview}
\PreviewEnvironment{tikzpicture}

\usepackage{color}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{algorithmic}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{tikz-qtree}
\usepackage[export]{adjustbox}


\usetikzlibrary{shapes.geometric, shapes.misc, shapes.arrows, shapes.callouts, shapes.multipart, fit, positioning, calc, matrix, automata, arrows.meta}

\definecolor{BehaviorTreeSelectorColor}{HTML}{00FFFF}
\definecolor{BehaviorTreeSequenceColor}{HTML}{FFA500}
\definecolor{BehaviorTreeParallelColor}{HTML}{FFD700}
\definecolor{BehaviorTreeLeafColor}{HTML}{C0C0C0}

\tikzset{
    Selector/.style={
        draw=black,
        fill=BehaviorTreeSelectorColor,
        text=black,
        shape=chamfered rectangle,
        minimum size=15pt,
        inner sep=0pt,
        font=\tiny
    },
    Sequence/.style={
        draw=black,
        fill=BehaviorTreeSequenceColor,
        text=black,
        shape=rectangle,
        minimum size=15pt,
        inner sep=0pt,
        font=\tiny
    },
    Parallel/.style={
        draw=black,
        fill=BehaviorTreeParallelColor,
        text=black,
        shape=trapezium,
        trapezium left angle=60,
        trapezium right angle=120,
        minimum size=15pt,
        inner sep=0pt,
        trapezium stretches body,
        font=\tiny,
        align=center
    },
    Decorator/.style={
        draw=black,
        fill=white,
        text=black,
        shape=trapezium,
        trapezium left angle=67,
        trapezium right angle=67,
        minimum size=15pt,
        inner sep=0pt,
        trapezium stretches body,
        font=\tiny,
        align=center
    },
    Action/.style={
        draw=black,
        fill=BehaviorTreeLeafColor,
        text=black,
        shape=ellipse,
        minimum size=15pt,
        inner sep=0pt,
        font=\tiny
    },
    Check/.style={
        draw=black,
        fill=BehaviorTreeLeafColor,
        text=red,
        shape=ellipse,
        minimum size=15pt,
        inner sep=0pt,
        font=\tiny
    },
    Blackboard/.style={
        draw=blue,
        fill=white,
        text=black,
        shape=rectangle,
        font=\tiny,
        inner sep = .5pt,
        inner xsep = -3pt,
        anchor = north
    }
}

\newcommand{\InvalidTikz}{\texttt{\itshape{I}}}
\newcommand{\FailureTikz}{\texttt{\itshape{F}}}
\newcommand{\RunningTikz}{\texttt{\itshape{R}}}
\newcommand{\SuccessTikz}{\texttt{\itshape{S}}}

\definecolor{BehaviorTreeBlackboardColor}{HTML}{0000FF} %blue
\definecolor{BehaviorTreeEnvironmentColor}{HTML}{FF8C00} %dark orange
\definecolor{NeuralVarColor}{HTML}{A0522D}
\newcommand{\NeuralVarTikz}[1]{\texttt{\itshape{\textcolor{NeuralVarColor}{#1}}}}
\newcommand{\EnvVarTikz}[1]{\texttt{\itshape{\textcolor{BehaviorTreeEnvironmentColor}{#1}}}}
\newcommand{\BlVarTikz}[1]{\texttt{\itshape{\textcolor{BehaviorTreeBlackboardColor}{#1}}}}

\newcommand{\SwapArrow}{\rightleftharpoons{}}
\newcommand{\NodeStatusTikz}{\texttt{\itshape{Status}}}
\newcommand{\True}{\top}
\newcommand{\False}{\bot}


\begin{document}
\begin{adjustbox}{max width = \linewidth}

\begin{tikzpicture}
\tikzset{level distance=20pt}
\tikzset{sibling distance=0.5pt}
\Tree[.\node[Sequence](Drone){$Drone$};
[.\node[Selector](StartSel){$StartSel$};
[.\node[Check](Started){\begin{tabular}{c}$Started$\end{tabular}};\node[Blackboard](StartedUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}(\BlVarTikz{mode} \neq \texttt{\textquotesingle{}off\textquotesingle{}})\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Action](Start){\begin{tabular}{c}$Start$\end{tabular}};\node[Blackboard](StartUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{camT} \in \end{math}\begin{math}\{\False{}\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}none\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{camStatus} \in \end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}failed\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}(\BlVarTikz{camStatus} = \texttt{\textquotesingle{}failed\textquotesingle{}})\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}on\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\quad{}\end{math}\texttt{if }\begin{math}(\BlVarTikz{camStatus} = \texttt{\textquotesingle{}on\textquotesingle{}})\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\begin{math}\{\texttt{\textquotesingle{}on\textquotesingle{}}, \texttt{\textquotesingle{}failed\textquotesingle{}}, \texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\texttt{))}\\\begin{math}\end{math}\begin{math}\BlVarTikz{droneStatus} \in \end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}failed\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}(\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}failed\textquotesingle{}})\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}on\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\quad{}\end{math}\texttt{if }\begin{math}(\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}on\textquotesingle{}})\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\begin{math}\{\texttt{\textquotesingle{}on\textquotesingle{}}, \texttt{\textquotesingle{}failed\textquotesingle{}}, \texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\texttt{))}\\\begin{math}\end{math}\begin{math}\BlVarTikz{mode} \in \end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}on\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}on\textquotesingle{}}) \land (\BlVarTikz{camStatus} = \texttt{\textquotesingle{}on\textquotesingle{}}))\end{math}\texttt{ else}\\\begin{math}\quad{}\end{math}\begin{math}\{\texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\texttt{)}\\\begin{math}\end{math}\texttt{if }\begin{math}((\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}on\textquotesingle{}}) \land (\BlVarTikz{camStatus} = \texttt{\textquotesingle{}on\textquotesingle{}}))\end{math}\texttt{:}\\\begin{math}\quad{}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq \SuccessTikz{}\end{math}\\\begin{math}\end{math}\texttt{elif }\begin{math}((\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}failed\textquotesingle{}}) \lor (\BlVarTikz{camStatus} = \texttt{\textquotesingle{}failed\textquotesingle{}}))\end{math}\texttt{:}\\\begin{math}\quad{}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq \FailureTikz{}\end{math}\\\begin{math}\end{math}\texttt{else:}\\\begin{math}\quad{}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
[.\node[Selector](ShutdownSel){$ShutdownSel$};
[.\node[Check](NotDone){\begin{tabular}{c}$NotDone$\end{tabular}};\node[Blackboard](NotDoneUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}(\BlVarTikz{mode} \neq \texttt{\textquotesingle{}done\textquotesingle{}})\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Action](Shutdown){\begin{tabular}{c}$Shutdown$\end{tabular}};\node[Blackboard](ShutdownUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{camT} \in \end{math}\begin{math}\{\False{}\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}none\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{camStatus} \in \end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}failed\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}(\BlVarTikz{camStatus} = \texttt{\textquotesingle{}failed\textquotesingle{}})\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\quad{}\end{math}\texttt{if }\begin{math}(\BlVarTikz{camStatus} = \texttt{\textquotesingle{}off\textquotesingle{}})\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\begin{math}\{\texttt{\textquotesingle{}on\textquotesingle{}}, \texttt{\textquotesingle{}failed\textquotesingle{}}, \texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\texttt{))}\\\begin{math}\end{math}\begin{math}\BlVarTikz{droneStatus} \in \end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}failed\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}(\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}failed\textquotesingle{}})\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\quad{}\end{math}\texttt{if }\begin{math}(\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}off\textquotesingle{}})\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\begin{math}\{\texttt{\textquotesingle{}on\textquotesingle{}}, \texttt{\textquotesingle{}failed\textquotesingle{}}, \texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\texttt{))}\\\begin{math}\end{math}\begin{math}\BlVarTikz{mode} \in \end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}off\textquotesingle{}}) \land (\BlVarTikz{camStatus} = \texttt{\textquotesingle{}off\textquotesingle{}}))\end{math}\texttt{ else}\\\begin{math}\quad{}\end{math}\begin{math}\{\texttt{\textquotesingle{}done\textquotesingle{}}\}\end{math}\texttt{)}\\\begin{math}\end{math}\texttt{if }\begin{math}((\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}failed\textquotesingle{}}) \lor (\BlVarTikz{camStatus} = \texttt{\textquotesingle{}failed\textquotesingle{}}))\end{math}\texttt{:}\\\begin{math}\quad{}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq \FailureTikz{}\end{math}\\\begin{math}\end{math}\texttt{else:}\\\begin{math}\quad{}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
[.\node[Selector](Main){$Main$};
[.\node[Sequence](LandingSeq){$LandingSeq$};
[.\node[Check](Landing){\begin{tabular}{c}$Landing$\end{tabular}};\node[Blackboard](LandingUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}((\BlVarTikz{move}) = \texttt{\textquotesingle{}land\textquotesingle{}})\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Selector](LandSel){$LandSel$};
[.\node[Check](Landed){\begin{tabular}{c}$Landed$\end{tabular}};\node[Blackboard](LandedUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}(\EnvVarTikz{z\_a} = 0)\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Action](Land){\begin{tabular}{c}$Land$\end{tabular}};\node[Blackboard](LandUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}land\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
]
[.\node[Sequence](ESeq){$ESeq$};
[.\node[Selector](ESel){$ESel$};
[.\node[Check](BCritical){\begin{tabular}{c}$BCritical$\end{tabular}};\node[Blackboard](BCriticalUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}(\EnvVarTikz{battery} = \texttt{\textquotesingle{}critical\textquotesingle{}})\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Check](LBad){\begin{tabular}{c}$LBad$\end{tabular}};\node[Blackboard](LBadUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}\neg (\EnvVarTikz{loc})\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
]
[.\node[Action](ELand){\begin{tabular}{c}$ELand$\end{tabular}};\node[Blackboard](ELandUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}land\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
[.\node[Sequence](FlightSeq){$FlightSeq$};
[.\node[Selector](TakeoffSel){$TakeoffSel$};
[.\node[Check](Tookoff){\begin{tabular}{c}$Tookoff$\end{tabular}};\node[Blackboard](TookoffUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}(\EnvVarTikz{z\_a} \geq 5)\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Action](Takeoff){\begin{tabular}{c}$Takeoff$\end{tabular}};\node[Blackboard](TakeoffUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}takeoff\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
[.\node[Selector](MoveSel){$MoveSel$};
[.\node[Sequence](LSeq){$LSeq$};
[.\node[Check](BLow){\begin{tabular}{c}$BLow$\end{tabular}};\node[Blackboard](BLowUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}(\EnvVarTikz{battery} = \texttt{\textquotesingle{}low\textquotesingle{}})\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Action](SetP0){\begin{tabular}{c}$SetP0$\\\begin{math}\{\texttt{p}\coloneqq{}0\}\end{math}\end{tabular}};\node[Blackboard](SetP0UPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{ind} \in \end{math}\begin{math}\{\texttt{p}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \SuccessTikz{}\end{math}\end{tabular}};]
[.\node[Selector](LSel){$LSel$};
[.\node[Check](AtP0){\begin{tabular}{c}$AtP0$\end{tabular}};\node[Blackboard](AtP0UPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}((\EnvVarTikz{x\_a} = \BlVarTikz{x\_g}) \land (\EnvVarTikz{y\_a} = \BlVarTikz{y\_g}) \land (\EnvVarTikz{z\_a} = \BlVarTikz{z\_g}))\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Action](GoTo0){\begin{tabular}{c}$GoTo0$\end{tabular}};\node[Blackboard](GoTo0UPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}fly\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
[.\node[Action](LLand){\begin{tabular}{c}$LLand$\end{tabular}};\node[Blackboard](LLandUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}land\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
[.\node[Sequence](MoveSeq){$MoveSeq$};
[.\node[Selector](ObjSel){$ObjSel$};
[.\node[Action](CameraTrack){\begin{tabular}{c}$CameraTrack$\end{tabular}};\node[Blackboard](CameraTrackUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{camT} \in \end{math}\begin{math}\{\True{}, \False{}\}\end{math}\\\begin{math}\end{math}\texttt{if }\begin{math}\BlVarTikz{camT}\end{math}\texttt{:}\\\begin{math}\quad{}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq \SuccessTikz{}\end{math}\\\begin{math}\end{math}\texttt{else:}\\\begin{math}\quad{}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \FailureTikz{}\end{math}\end{tabular}};]
[.\node[Sequence](PointSeq){$PointSeq$};
[.\node[Action](SetMinP){\begin{tabular}{c}$SetMinP$\end{tabular}};\node[Blackboard](SetMinPUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{ind} \in \end{math}\texttt{(}\begin{math}\{1\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}(\BlVarTikz{ind} = 0)\end{math}\texttt{ else}\\\begin{math}\quad{}\end{math}\begin{math}\{\BlVarTikz{ind}\}\end{math}\texttt{)}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \SuccessTikz{}\end{math}\end{tabular}};]
[.\node[Selector](PointSel){$PointSel$};
[.\node[Check](AtP){\begin{tabular}{c}$AtP$\end{tabular}};\node[Blackboard](AtPUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}((\EnvVarTikz{x\_a} = \BlVarTikz{x\_g}) \land (\EnvVarTikz{y\_a} = \BlVarTikz{y\_g}) \land (\EnvVarTikz{z\_a} = \BlVarTikz{z\_g}))\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Action](IncP){\begin{tabular}{c}$IncP$\end{tabular}};\node[Blackboard](IncPUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{ind} \in \end{math}\begin{math}\{min(16, (\BlVarTikz{ind} + 1))\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \SuccessTikz{}\end{math}\end{tabular}};]
]
[.\node[Selector](FinalSel){$FinalSel$};
[.\node[Check](MaxP){\begin{tabular}{c}$MaxP$\end{tabular}};\node[Blackboard](MaxPUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}(16 = \BlVarTikz{ind})\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Action](GoToP){\begin{tabular}{c}$GoToP$\end{tabular}};\node[Blackboard](GoToPUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}fly\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
]
]
[.\node[Action](SetPMax){\begin{tabular}{c}$SetPMax$\\\begin{math}\{\texttt{p}\coloneqq{}16\}\end{math}\end{tabular}};\node[Blackboard](SetPMaxUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{ind} \in \end{math}\begin{math}\{\texttt{p}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \SuccessTikz{}\end{math}\end{tabular}};]
[.\node[Selector](MaxSel){$MaxSel$};
[.\node[Check](AtPMax){\begin{tabular}{c}$AtPMax$\end{tabular}};\node[Blackboard](AtPMaxUPDATEBLACKBOARD){\begin{tabular}{l}\texttt{if }\begin{math}((\EnvVarTikz{x\_a} = \BlVarTikz{x\_g}) \land (\EnvVarTikz{y\_a} = \BlVarTikz{y\_g}) \land (\EnvVarTikz{z\_a} = \BlVarTikz{z\_g}))\end{math}\texttt{:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{} \SuccessTikz{}\end{math}\\{}\texttt{else:}\\{}\begin{math}\quad{}\NodeStatusTikz{}\coloneqq{}\FailureTikz{}\end{math}\end{tabular}};]
[.\node[Action](GoToMax){\begin{tabular}{c}$GoToMax$\end{tabular}};\node[Blackboard](GoToMaxUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}fly\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
[.\node[Action](GLand){\begin{tabular}{c}$GLand$\end{tabular}};\node[Blackboard](GLandUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}land\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \RunningTikz{}\end{math}\end{tabular}};]
]
]
]
]
[.\node[Action](Report){\begin{tabular}{c}$Report$\end{tabular}};\node[Blackboard](ReportUPDATEBLACKBOARD){\begin{tabular}{l}\begin{math}\end{math}\texttt{if }\begin{math}\BlVarTikz{camT}\end{math}\texttt{:}\\\begin{math}\quad{}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq \SuccessTikz{}\end{math}\\\begin{math}\end{math}\texttt{else:}\\\begin{math}\quad{}\end{math}\begin{math}\NodeStatusTikz{} \coloneqq{} \FailureTikz{}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{camT} \in \end{math}\begin{math}\{\False{}\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{mode} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}done\textquotesingle{}}\}\end{math}\end{tabular}};]
]
\node[Blackboard, anchor=south east] (initialValues) at ([xshift=-5pt, yshift=5pt]Drone.north west){\begin{tabular}{l}\texttt{-INITIAL VALUES-}\\{}\begin{math}\end{math}\begin{math}\BlVarTikz{droneStatus} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{camStatus} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{mode} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}off\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{camT} \in \end{math}\begin{math}\{\False{}\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{move} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}none\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\texttt{temp} \coloneqq{}\end{math}[(0, \begin{math}(-10)\end{math}), (1, \begin{math}(-10)\end{math}), (2, \begin{math}5\end{math}), (3, \begin{math}(-30)\end{math}\texttt{}), (4, \begin{math}(-30)\end{math}\texttt{}), (5, \begin{math}20\end{math}\texttt{}), (6, \begin{math}(-15)\end{math}\texttt{}), (7, \begin{math}30\end{math}\texttt{}), (8, \begin{math}20\end{math}\texttt{}), (9, \begin{math}0\end{math}\texttt{}), (10, \begin{math}(-30)\end{math}\texttt{}), (11, \begin{math}20\end{math}\texttt{}), (12, \begin{math}15\end{math}\texttt{}), (13, \begin{math}30\end{math}\texttt{}), (14, \begin{math}20\end{math}\texttt{}), (15, \begin{math}30\end{math}\texttt{}), (16, \begin{math}(-30)\end{math}\texttt{}), (17, \begin{math}20\end{math}\texttt{}), (18, \begin{math}(-30)\end{math}\texttt{}), (19, \begin{math}(-30)\end{math}\texttt{}), (20, \begin{math}40\end{math}\texttt{}), (21, \begin{math}(-15)\end{math}\texttt{}), (22, \begin{math}30\end{math}\texttt{}), (23, \begin{math}40\end{math}\texttt{}), (24, \begin{math}0\end{math}\texttt{}), (25, \begin{math}(-30)\end{math}\texttt{}), (26, \begin{math}40\end{math}\texttt{}), (27, \begin{math}15\end{math}\texttt{}), (28, \begin{math}30\end{math}\texttt{}), (29, \begin{math}40\end{math}\texttt{}), (30, \begin{math}30\end{math}\texttt{}), (31, \begin{math}(-30)\end{math}\texttt{}), (32, \begin{math}40\end{math}\texttt{}), (33, \begin{math}(-30)\end{math}\texttt{}), (34, \begin{math}(-30)\end{math}\texttt{}), (35, \begin{math}60\end{math}\texttt{}), (36, \begin{math}(-15)\end{math}\texttt{}), (37, \begin{math}30\end{math}\texttt{}), (38, \begin{math}60\end{math}\texttt{}), (39, \begin{math}0\end{math}\texttt{}), (40, \begin{math}(-30)\end{math}\texttt{}), (41, \begin{math}60\end{math}\texttt{}), (42, \begin{math}15\end{math}\texttt{}), (43, \begin{math}30\end{math}\texttt{}), (44, \begin{math}60\end{math}\texttt{}), (45, \begin{math}30\end{math}\texttt{}), (46, \begin{math}(-30)\end{math}\texttt{}), (47, \begin{math}60\end{math}\texttt{}), (48, \begin{math}0\end{math}), (49, \begin{math}0\end{math}), (50, \begin{math}60\end{math})]\\\begin{math}\end{math}\texttt{for (index, val) in temp:}\\\begin{math}\quad{}\end{math}\begin{math}\BlVarTikz{xyz}[\texttt{index}] \coloneqq{} \texttt{val}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{ind} \in \end{math}\begin{math}\{0\}\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{x\_g} \coloneqq{} \end{math}\begin{math}\BlVarTikz{xyz}[(0 + (3 \cdot \BlVarTikz{ind}))]\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{y\_g} \coloneqq{} \end{math}\begin{math}\BlVarTikz{xyz}[(1 + (3 \cdot \BlVarTikz{ind}))]\end{math}\\\begin{math}\end{math}\begin{math}\BlVarTikz{z\_g} \coloneqq{} \end{math}\begin{math}\BlVarTikz{xyz}[(2 + (3 \cdot \BlVarTikz{ind}))]\end{math}\\\begin{math}\end{math}\begin{math}\EnvVarTikz{x\_a} \in \end{math}\begin{math}\{0\}\end{math}\\\begin{math}\end{math}\begin{math}\EnvVarTikz{y\_a} \in \end{math}\begin{math}\{0\}\end{math}\\\begin{math}\end{math}\begin{math}\EnvVarTikz{z\_a} \in \end{math}\begin{math}\{0\}\end{math}\\\begin{math}\end{math}\begin{math}\EnvVarTikz{battery} \in \end{math}\begin{math}\{\texttt{\textquotesingle{}good\textquotesingle{}}\}\end{math}\\\begin{math}\end{math}\begin{math}\EnvVarTikz{loc} \in \end{math}\begin{math}\{\True{}, \False{}\}\end{math}\\\end{tabular}};
\node[Blackboard, anchor=south east] (varInfo) at ([xshift=-5pt]initialValues.south west){\begin{tabular}{l}\texttt{-VARIABLE INFO-}\\{}\BlVarTikz{droneStatus} - \texttt{VAR} - \texttt{\{}\texttt{\textquotesingle{}off\textquotesingle{}}, \texttt{\textquotesingle{}on\textquotesingle{}}, \texttt{\textquotesingle{}failed\textquotesingle{}}\texttt{\}}\\{}\BlVarTikz{camStatus} - \texttt{VAR} - \texttt{\{}\texttt{\textquotesingle{}off\textquotesingle{}}, \texttt{\textquotesingle{}on\textquotesingle{}}, \texttt{\textquotesingle{}failed\textquotesingle{}}\texttt{\}}\\{}\BlVarTikz{mode} - \texttt{VAR} - \texttt{\{}\texttt{\textquotesingle{}off\textquotesingle{}}, \texttt{\textquotesingle{}on\textquotesingle{}}, \texttt{\textquotesingle{}done\textquotesingle{}}\texttt{\}}\\{}\BlVarTikz{camT} - \texttt{VAR} - \texttt{BOOLEAN}\\{}\BlVarTikz{move} - \texttt{VAR} - \texttt{\{}\texttt{\textquotesingle{}none\textquotesingle{}}, \texttt{\textquotesingle{}land\textquotesingle{}}, \texttt{\textquotesingle{}takeoff\textquotesingle{}}, \texttt{\textquotesingle{}fly\textquotesingle{}}\texttt{\}}\\{}\BlVarTikz{xyz} - \texttt{array 51} - \texttt{DEFINE} - \texttt{INT}\\{}\BlVarTikz{ind} - \texttt{VAR} - [0, 16]\\{}\BlVarTikz{x\_g} - \texttt{DEFINE} - \texttt{INT}\\{}\BlVarTikz{y\_g} - \texttt{DEFINE} - \texttt{INT}\\{}\BlVarTikz{z\_g} - \texttt{DEFINE} - \texttt{INT}\\{}\EnvVarTikz{x\_a} - \texttt{VAR} - [-30, 30]\\{}\EnvVarTikz{y\_a} - \texttt{VAR} - [-30, 30]\\{}\EnvVarTikz{z\_a} - \texttt{VAR} - [0, 80]\\{}\EnvVarTikz{battery} - \texttt{VAR} - \texttt{\{}\texttt{\textquotesingle{}good\textquotesingle{}}, \texttt{\textquotesingle{}low\textquotesingle{}}, \texttt{\textquotesingle{}critical\textquotesingle{}}\texttt{\}}\\{}\EnvVarTikz{loc} - \texttt{VAR} - \texttt{BOOLEAN}\end{tabular}};
\node[Blackboard, anchor=south west] (environmentUpdates) at ([xshift=5pt, yshift=5pt]Drone.north east){\begin{tabular}{l}\texttt{-ENVIRONMENT UPDATES-}\\{}\begin{math}\end{math}\begin{math}\EnvVarTikz{loc} \in \end{math}\begin{math}\{\True{}, \False{}\}\end{math}\\\begin{math}\end{math}\begin{math}\EnvVarTikz{battery} \in \end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}good\textquotesingle{}}, \texttt{\textquotesingle{}low\textquotesingle{}}, \texttt{\textquotesingle{}critical\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}((\EnvVarTikz{x\_a} = (-10)) \land (\EnvVarTikz{y\_a} = (-10)) \land (\EnvVarTikz{z\_a} = 0) \land (\EnvVarTikz{battery} = \texttt{\textquotesingle{}critical\textquotesingle{}}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}good\textquotesingle{}}, \texttt{\textquotesingle{}low\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\quad{}\end{math}\texttt{if }\begin{math}((\EnvVarTikz{x\_a} = (-10)) \land (\EnvVarTikz{y\_a} = (-10)) \land (\EnvVarTikz{z\_a} = 0) \land (\EnvVarTikz{battery} = \texttt{\textquotesingle{}low\textquotesingle{}}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}good\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\quad{}\quad{}\end{math}\texttt{if }\begin{math}((\EnvVarTikz{x\_a} = (-10)) \land (\EnvVarTikz{y\_a} = (-10)) \land (\EnvVarTikz{z\_a} = 0) \land (\EnvVarTikz{battery} = \texttt{\textquotesingle{}good\textquotesingle{}}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}good\textquotesingle{}}, \texttt{\textquotesingle{}low\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\quad{}\quad{}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}on\textquotesingle{}}) \land (\EnvVarTikz{battery} = \texttt{\textquotesingle{}good\textquotesingle{}}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\quad{}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{\texttt{\textquotesingle{}low\textquotesingle{}}, \texttt{\textquotesingle{}critical\textquotesingle{}}\}\end{math}\\\begin{math}\quad{}\quad{}\quad{}\quad{}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{droneStatus} = \texttt{\textquotesingle{}on\textquotesingle{}}) \land (\EnvVarTikz{battery} = \texttt{\textquotesingle{}low\textquotesingle{}}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\quad{}\quad{}\quad{}\end{math}\begin{math}\{\EnvVarTikz{battery}\}\end{math}\texttt{)))))}\\\begin{math}\end{math}\begin{math}\EnvVarTikz{x\_a} \in \end{math}\texttt{(}\begin{math}\{(\EnvVarTikz{x\_a} + 1)\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{move} = \texttt{\textquotesingle{}fly\textquotesingle{}}) \land (\EnvVarTikz{x\_a} < \BlVarTikz{x\_g}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{(\EnvVarTikz{x\_a} - 1)\}\end{math}\\\begin{math}\quad{}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{move} = \texttt{\textquotesingle{}fly\textquotesingle{}}) \land (\EnvVarTikz{x\_a} > \BlVarTikz{x\_g}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\begin{math}\{\EnvVarTikz{x\_a}\}\end{math}\texttt{))}\\\begin{math}\end{math}\begin{math}\EnvVarTikz{y\_a} \in \end{math}\texttt{(}\begin{math}\{(\EnvVarTikz{y\_a} + 1)\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{move} = \texttt{\textquotesingle{}fly\textquotesingle{}}) \land (\EnvVarTikz{y\_a} < \BlVarTikz{y\_g}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{(\EnvVarTikz{y\_a} - 1)\}\end{math}\\\begin{math}\quad{}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{move} = \texttt{\textquotesingle{}fly\textquotesingle{}}) \land (\EnvVarTikz{y\_a} > \BlVarTikz{y\_g}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\begin{math}\{\EnvVarTikz{y\_a}\}\end{math}\texttt{))}\\\begin{math}\end{math}\begin{math}\EnvVarTikz{z\_a} \in \end{math}\texttt{(}\begin{math}\{(\EnvVarTikz{z\_a} + 1)\}\end{math}\\\begin{math}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{move} = \texttt{\textquotesingle{}fly\textquotesingle{}}) \land (\EnvVarTikz{z\_a} < \BlVarTikz{z\_g}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{(\EnvVarTikz{z\_a} - 1)\}\end{math}\\\begin{math}\quad{}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{move} = \texttt{\textquotesingle{}fly\textquotesingle{}}) \land (\EnvVarTikz{z\_a} > \BlVarTikz{z\_g}))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{(\EnvVarTikz{z\_a} + 1)\}\end{math}\\\begin{math}\quad{}\quad{}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{move} = \texttt{\textquotesingle{}takeoff\textquotesingle{}}) \land (\EnvVarTikz{z\_a} < 5))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\quad{}\quad{}\end{math}\texttt{(}\begin{math}\{(\EnvVarTikz{z\_a} - 1)\}\end{math}\\\begin{math}\quad{}\quad{}\quad{}\quad{}\end{math}\texttt{if }\begin{math}((\BlVarTikz{move} = \texttt{\textquotesingle{}land\textquotesingle{}}) \land (\EnvVarTikz{z\_a} > 0))\end{math}\texttt{ else}\\\begin{math}\quad{}\quad{}\quad{}\quad{}\end{math}\begin{math}\{\EnvVarTikz{z\_a}\}\end{math}\texttt{))))}\\\end{tabular}};
\end{tikzpicture}
\end{adjustbox}
\end{document}
